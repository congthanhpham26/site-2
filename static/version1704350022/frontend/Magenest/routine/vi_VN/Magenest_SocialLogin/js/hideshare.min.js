/*! hideshare - v0.1.0 - 2013-09-11
 * https://github.com/arnonate/jQuery-FASS-Widget
 * Copyright (c) 2013 Nate Arnold; Licensed MIT */
define(['jquery'], function() {
    (function(window, $) {
        "use strict";
        var Hideshare = function(elem, options) {
            this.elem = elem;
            this.$elem = $(elem);
            this.options = options;
        };
        Hideshare.prototype = {
            defaults: {
                link: document.URL,
                title: document.title,
                description: '',
                media: null,
                twitter: true,
                facebook: true,
                linkedin: true,
                pinterest: true,
                reddit: true,
                position: "bottom",
                speed: 100
            },
            init: function() {
                this.config = $.extend({}, this.defaults, this.options);
                this.wrapHideshare();
                return this;
            },
            wrapHideshare: function() {
                var output = output,
                    width = this.$elem.outerWidth(),
                    height = this.$elem.outerHeight(),
                    liWidth = 0,
                    placement = this.config.position,
                    transition = this.config.speed,
                    shareTitle = this.config.title,
                    shareLink = this.config.link,
                    shareMedia = this.config.media,
                    shareDescription = this.config.description,
                    twitterTemplate = '<li><a class="hideshare-twitter" href="#"><div class="twitter-share"></div></a></li>',
                    facebookTemplate = '<li><a class="hideshare-facebook" href="#"><div class="facebook-share"></div></a></li>',
                    linkedinTemplate = '<li><a class="hideshare-linkedin" href="#"><div class="linkedin-share"></div></a></li>',
                    pinterestTemplate = '<li><a class="hideshare-pinterest" href="#" data-pin-do="buttonPin" data-pin-config="above"><div class="pinterest-share"></div></a></li>',
                    redditTemplate = '<li><a class="hideshare-reddit" href="#"><div class="reddit-share"></div></a></li>';
                if (this.config.twitter) {
                    output = twitterTemplate;
                    liWidth += 45;
                } else {
                    output = "";
                    liWidth = liWidth;
                }
                if (this.config.facebook) {
                    output += facebookTemplate;
                    liWidth += 45;
                } else {
                    output = output;
                    liWidth = liWidth;
                }
                if (this.config.linkedin) {
                    output += linkedinTemplate;
                    liWidth += 45;
                } else {
                    output = output;
                    liWidth = liWidth;
                }
                if (this.config.pinterest) {
                    output += pinterestTemplate;
                    liWidth += 45;
                } else {
                    output = output;
                    liWidth = liWidth;
                }
                if (this.config.reddit) {
                    output += redditTemplate;
                    liWidth += 45;
                } else {
                    output = output;
                    liWidth = liWidth;
                }
                if (liWidth < width) {
                    liWidth = width;
                }
                var hideshareList = '<ul class="hideshare-list" style=" width: ' + liWidth + 'px' + '">' + output + '</ul>';
                this.$elem.addClass("hideshare-btn").wrap("<div class='hideshare-wrap' style='width:" + width + "px; height:" + height + "px;' />");
                this.$wrap = this.$elem.parent();
                $(hideshareList).insertAfter(this.$elem);
                var getPlacement = function(placement, width, height, speed, $wrap) {
                    var styles = {};
                    if (placement === "right") {
                        styles = {
                            "left": width + 10 + "px",
                            "right": -(width + 10) + "px",
                            "opacity": "toggle"
                        };
                    } else if (placement === "left") {
                        styles = {
                            "left": -(width + 10) + "px",
                            "right": width + 10 + "px",
                            "opacity": "toggle"
                        };
                    } else if (placement === "top") {
                        styles = {
                            "top": -(height + 10) + "px",
                            "bottom": height + 10 + "px",
                            "opacity": "toggle"
                        };
                    } else {
                        styles = {
                            "top": height + 10 + "px",
                            "bottom": -(height + 10) + "px",
                            "left": "0px",
                            "opacity": "toggle"
                        };
                    }
                    $wrap.find(".hideshare-list").animate(styles, speed).addClass("shown");
                };
                var returnPlacement = function(speed, $wrap) {
                    var styles = {
                        "top": "0px",
                        "left": "0px",
                        "opacity": "toggle"
                    };
                    $wrap.find(".hideshare-list").animate(styles, speed).removeClass("shown");
                };
                var shareTwitter = function() {
                    window.open('https://twitter.com/intent/tweet?original_referer=' + encodeURIComponent(shareLink) + '&text=' + encodeURIComponent(shareTitle) + '%20' + encodeURIComponent(shareLink), 'Twitter', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');
                };
                var shareFacebook = function() {
                    window.open('//www.facebook.com/share.php?m2w&s=100&p[url]=' + encodeURIComponent(shareLink) + '&p[images][0]=' + encodeURIComponent(shareMedia) + '&p[title]=' + encodeURIComponent(shareTitle) + '&p[summary]=' + encodeURIComponent(shareDescription), 'Facebook', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');
                };
                var shareLinkedIn = function() {
                    window.open('//www.linkedin.com/shareArticle?mini=true&url=' + encodeURIComponent(shareLink) + '&title=' + encodeURIComponent(shareTitle) + '&source=' + encodeURIComponent(shareLink), 'LinkedIn', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');
                };
                var sharePinterest = function() {
                    window.open('//pinterest.com/pin/create/button/?url=' + encodeURIComponent(shareLink) + '&media=' + encodeURIComponent(shareMedia) + '&description=' + encodeURIComponent(shareTitle), 'Pinterest', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');
                };
                var shareReddit = function() {
                    window.open('https://www.reddit.com/submit?url=' + encodeURIComponent(shareLink) + '&title=' + encodeURIComponent(shareTitle) + '%20' + encodeURIComponent(shareLink), 'Reddit', 'menubar=no,toolbar=no,resizable=yes,scrollbars=yes,height=600,width=600');
                };
                this.$wrap.find(".hideshare-twitter").click(function() {
                    shareTwitter();
                    return false;
                });
                this.$wrap.find(".hideshare-facebook").click(function() {
                    shareFacebook();
                    return false;
                });
                this.$wrap.find(".hideshare-linkedin").click(function() {
                    shareLinkedIn();
                    return false;
                });
                this.$wrap.find(".hideshare-pinterest").click(function() {
                    sharePinterest();
                    return false;
                });
                this.$wrap.find(".hideshare-reddit").click(function() {
                    shareReddit();
                    return false;
                });
            }
        };
        Hideshare.defaults = Hideshare.prototype.defaults;
        $.fn.hideshare = function(options) {
            return this.each(function() {
                new Hideshare(this, options).init();
            });
        };
        window.Hideshare = Hideshare;
    })(window, jQuery);
});