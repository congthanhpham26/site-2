define(['jquery', 'jquery-ui-modules/widget'], function($) {
    'use strict';
    return function() {
        $.widget('mage.productVideoLoader', $.mage.productVideoLoader, {
            _create: function() {
                switch (this.element.data('type')) {
                    case 'youtube':
                        this.element.videoYoutube();
                        this._player = this.element.data('mageVideoYoutube');
                        break;
                    case 'vimeo':
                        this.element.videoVimeo();
                        this._player = this.element.data('mageVideoVimeo');
                        break;
                    case 'video':
                        this.element.videoUpload();
                        this._player = this.element.data('mageVideoUpload');
                        break;
                    default:
                        throw {
                            name: 'Video Error',
                            message: 'Unknown video type',
                            toString: function() {
                                return this.name + ': ' + this.message;
                            }
                        };
                }
            },
        });
        $.widget('mage.videoUpload', $.mage.productVideoLoader, {
            _create: function() {
                this._initialize();
                this.element.append('<video style="z-index: 99;" width="' + this._width + '" height="' + this._height + '" loop muted autoplay playsinline>\n' + '  <source src="' + this.element.data('videourl') + '" type="video/mp4">\n' + '  Your browser does not support the video tag.\n' + '</video>');
                $(this.element).closest('.fotorama__stage__frame').addClass('fotorama__product-video--loaded');
            }
        });
        return $.mage.productVideoLoader;
    };
});